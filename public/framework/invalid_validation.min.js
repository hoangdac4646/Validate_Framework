var script=document.createElement("script");script.src="https://code.jquery.com/jquery-3.4.1.min.js",script.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(script);class FacadeValidator{constructor(){console.log("constructor FacadeValidator"),this.validatorFactory=new PrototypeValidatorFactory}validate(e,t){this.resetMessageNotify(),this.getMessFactory(t.errorDisplay),this.arrInvalid=[],$.each(e,function(e,t){var s=this.validateInputWithRule(e,t);console.log("[validate] result "+s),null!=s&&(this.arrInvalid.push(s),this.addMessage(s))}.bind(this)),console.log("Result = "+JSON.stringify(this.arrInvalid)),this.showMessage()}getMessFactory(e){if(e)switch(e){case"console":this.messFactory=new ConsoleMessFactory;break;case"alert":this.messFactory=new AlertMessFactory;break;case"default":default:this.messFactory=new UIMessFactory}else this.messFactory=new UIMessFactory;this.message=new Message(this.messFactory)}addMethod(e,t,s){this.validatorFactory.addMethod(e,t,s)}showMessage(){this.message.show(),console.log("mess showed")}addMessage(e){var t={inputSelector:$("input[name="+e.tagName+"]"),icon:{path:e.path},text:{content:e.message}};this.message.add(this.messFactory.createIcon(t)),this.message.add(this.messFactory.createText(t))}resetMessageNotify(){$(".message").remove(),this.message=new Message(this.messFactory)}initValidatorFactory(){}getValidatorByType(e){return this.validatorFactory.getValidator(e)}getInputByName(e){return $("input[name='"+e+"']").val()}validateInputWithRule(e,t){var s=!0,r="";return $.each(t,function(t,a){var n=this.getValidatorByType(t);if(n){var o=this.getInputByName(e);if(!(s=n.check(o,a)))return r=n.getErrorMessage(e,a),!1}}.bind(this)),s?null:{tagName:e,message:r}}}FacadeValidator._instance=null,FacadeValidator.getInstance=function(){return null==FacadeValidator._instance&&(FacadeValidator._instance=new FacadeValidator),FacadeValidator._instance};class IValidatorFactory{constructor(){}addMethod(){}getValidator(){}}class PrototypeValidatorFactory extends IValidatorFactory{constructor(){super(),this.listValidator={email:new EmailValidator,equal:new EqualValidator,ipAddress:new IpAddressValidator,macAddress:new MacAddressValidator,min:new MinValidator,max:new MaxValidator,number:new IsNumberValidator,minLength:new MinLenghtValidator,maxLength:new MaxLenghtValidator,time:new TimeValidator,url:new UrlValidator}}getValidator(e){return this.listValidator[e]}addMethod(e,t,s){var r=new CommonValidator(t,s);this.listValidator[e]=r}}class CommonValidator{constructor(e,t){e||(e=this.createCheckFunc()),t||(t=this.createMessageFunc()),this.check=e,this.getErrorMessage=t}createCheckFunc(){throw new Error("Derived class must override method createCheckFunc!")}createMessageFunc(){throw new Error("Derived class must override method createMessageFunc!")}}class EmailValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.toLowerCase())}}createMessageFunc(){return function(e,t){return"Email is invalid"}}}class EqualValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e,t){return e===$(t).val()}}createMessageFunc(){return function(e,t){return e+" must be equal to"+t}}}class IpAddressValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e){return/^(?:(?:^|\.)(?:2(?:5[0-5]|[0-4]\d)|1?\d?\d)){4}$/.test(e)}}createMessageFunc(){return function(e,t){return"Ip address is invalid!"}}}class MacAddressValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e){return/^(([A-Fa-f0-9]{2}[:]){5}[A-Fa-f0-9]{2}[,]?)+$/i.test(e)}}createMessageFunc(){return function(e,t){return"MAC address is invalid! (Format: xx:xx:xx:xx:xx:xx)"}}}class MinValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e,t){var s=parseInt(e);return!Number.isNaN(s)&&s>=t}}createMessageFunc(){return function(e,t){return e+" must be greater than "+t}}}class MaxValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e,t){var s=parseInt(e);return!Number.isNaN(s)&&s<=t}}createMessageFunc(){return function(e,t){return e+" must be less than "+t}}}class IsNumberValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e,t){return/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)}}createMessageFunc(){return function(e,t){return e+" must be a number"}}}class MinLenghtValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e,t){return console.log("[MinLenghtValidator] "+e+" "+t),e.length>=t}}createMessageFunc(){return function(e,t){return e+" must be at least "+t+" character(s)"}}}class MaxLenghtValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e,t){return e.length<=t}}createMessageFunc(){return function(e,t){return e+" must be at most "+t+" character(s)"}}}class TimeValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e){return/^([0-1]?[0-9]|2[0-4]):([0-5][0-9])(:[0-5][0-9])?$/.test(e)}}createMessageFunc(){return function(e,t){return"Time is invalid! (require 00:00 - 23:59)"}}}class UrlValidator extends CommonValidator{constructor(){super()}createCheckFunc(){return function(e){return/^(http[s]?:\/\/){0,1}(www\.){0,1}[a-zA-Z0-9\.\-]+\.[a-zA-Z]{2,5}[\.]{0,1}/.test(e)}}createMessageFunc(){return function(e,t){return"Url is invalid!"}}}class Message{constructor(e){this.factory=e,this.messElement=[]}show(){this.messElement.forEach(function(e){e.show()})}add(e){this.messElement.push(e)}}class MessageFactory{constructor(){console.log("constructor MessageFactory")}createIcon(e){return new Icon(e)}createText(e){return new Text(e)}}class ConsoleMessFactory extends MessageFactory{createText(e){return new ConsoleText(e)}}class UIMessFactory extends MessageFactory{constructor(){super()}createIcon(e){return new UIIcon(e)}createText(e){return new UIText(e)}}class AlertMessFactory extends MessageFactory{constructor(){super()}createText(e){return new AlertText(e)}}class MessageElement{constructor(e){this.inputSelector=e.inputSelector}show(){return""}}class Icon extends MessageElement{constructor(e){super(e),this.path=e.icon.path}show(){}}class Text extends MessageElement{constructor(e){super(e),this.content=e.text.content}show(){}}class ConsoleText extends Text{constructor(e){super(e)}show(){this.inputSelector?console.error("Input name: "+this.inputSelector.attr("name")+" - Error: "+this.content):console.log("Invalid selector")}}class UIText extends Text{constructor(e){super(e)}show(){var e=this.inputSelector.parent();if(e){var t='<strong class="message-content">'+this.content+"</strong>";if(e.find(".message")[0])$(e.find(".message")[0]).append(t);else{var s="<div class='message'>";s+=t+"</div>",e.append(s)}}else console.log("Invalid selector")}}class UIIcon extends Icon{constructor(e){super(e)}show(){var e=this.inputSelector.parent();if(e){var t;if(t=this.path?"<img class='message-icon' src="+this.path+">":"<img class='message-icon' src='../framework/img/cancel.png'>",e.find(".message")[0])$(e.find(".message")[0]).append(t);else{var s="<div class='message'>";s+=t+"</div>",e.prepend(s)}}else console.log("Invalid selector")}}class AlertText extends Text{constructor(e){super(e)}show(){this.inputSelector?alert("Input name: "+this.inputSelector.attr("name")+" - Error: "+this.content):console.log("Invalid selector")}}